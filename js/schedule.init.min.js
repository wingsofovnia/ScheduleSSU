$(document).ready(function(){var b=0;var d={format:"dd.mm.yyyy",language:"ua",orientation:"top auto",todayHighlight:true,daysOfWeekDisabled:"0"};$(".input-group.date").each(function(){var l=$(this).find('input[type="text"]');if($(this).hasClass("next")){d.startDate="+7d";l.val(Service.getNextDatetime())}else{d.startDate="0d";l.val(Service.getDatetime())}$(this).datepicker(d)});var j=$("button.btn-request");function k(l,m,n){l.val(n.item.label);m.val(n.item.value)}var f=$('div.input-group.groups input[type="text"]');var g=$('div.input-group.groups input[type="hidden"]');var i=$("div.input-group.groups .loading");var a=$("div.input-group.groups a.clear-input");var h=$("a.group-placeholder");f.on("change",function(){f.val("");g.val("");a.hide()});f.autocomplete({source:"php/index.php?method=getGroups",minLength:1,search:function(){g.val("");i.fadeIn()},response:function(){i.promise().done(function(){i.fadeOut()})},select:function(l,m){k(f,g,m);a.show();j.focus();return false},focus:function(l,m){k(f,g,m);return false}});$(".paramSwitch").click(function(){var s=$("div.params");s.toggle();if(s.hasClass("loaded")){return true}s.addClass("loaded");var l=$('div.input-group.teacher input[type="text"]');var n=$('div.input-group.teacher input[type="hidden"]');var m=$("div.input-group.teacher .loading");var q=$("div.input-group.teacher a.clear-input");l.on("change",function(){l.val("");n.val("");a.hide()});l.autocomplete({source:"php/index.php?method=getTeachers",minLength:2,search:function(){n.val("");m.fadeIn()},response:function(){m.promise().done(function(){m.fadeOut()})},select:function(u,v){k(l,n,v);j.focus();q.show();return false},focus:function(u,v){k(l,n,v);return false}});var o=$('div.input-group.auditorium input[type="text"]');var t=$('div.input-group.auditorium input[type="hidden"]');var p=$("div.input-group.auditorium .loading");var r=$("div.input-group.auditorium a.clear-input");o.on("change",function(){o.val("");t.val("");a.hide()});o.autocomplete({source:"php/index.php?method=getAuditoriums",minLength:1,search:function(){p.fadeIn();t.val("")},response:function(){p.promise().done(function(){p.fadeOut()})},select:function(u,v){k(o,t,v);j.focus();r.show();return false},focus:function(u,v){k(o,t,v);return false}})});j.click(function(){if((f.val()==""||g.val()=="")&&($('div.auditorium input[type="text"]').val()==""||$('div.auditorium input[type="hidden"]').val()=="")&&($('div.teacher input[type="text"]').val()==""||$('div.teacher input[type="hidden"]').val()=="")){Service.alert("<strong>Помилка!</strong> Хоча б одне поле <strong>Група/Аудиторія/Викладач</strong> повинно бути обрано з випадаючого списку.");return}Service.showCogWheel();$.ajax({url:"php/index.php?method=getSchedule",timeout:8000,type:"GET",data:$("form.requestForm").serialize()}).done(function(l){$("div.form.schedule div.panel-body").html(l);$("div.form.schedule").show();b=$("div.form.schedule").offset().top-20;$("html, body").scrollTop(b)}).fail(function(l,m){Service.alert("<strong>Помилка!</strong> Сервер розкладу часто глючить, тому спробуйте повторно відіслати запит. Текст помилки: <strong>"+m+"</strong>")}).always(function(){Service.hideCogWheel()})});$("footer").click(function(){$("html, body").scrollTop(b)});var c=$("a.clear-input");c.on("click",function(m){m.preventDefault();var l=$(this).closest("div.input-group");$(this).hide();l.find("input").val("")});var e=$('input[name="remember"]');if(Service.isCookiefied()){e.prop("checked",true);f.val(Service.getCookiefiedGroupName());g.val(Service.getCookiefiedGroupId());j.click();a.show();h.html(Service.getCookiefiedGroupName());h.show()}e.on("click",function(){var m=g.val();var l=f.val();if(e.is(":checked")&&m&&l){Service.cookifyGroup(g.val(),f.val());h.html(f.val());h.show()}else{if(!e.is(":checked")){h.hide();Service.decookifyGroup()}}});h.on("click",function(l){l.preventDefault();f.val(Service.getCookiefiedGroupName());g.val(Service.getCookiefiedGroupId());a.show()})});